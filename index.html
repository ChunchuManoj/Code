<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java Programs</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            margin: 20px;
        }
        code {
            display: block;
            white-space: pre-wrap;
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

<h1>Java Programs</h1>

<code>
9. Write a program to implement the Diffie-Hellman Key Exchange mechanism using HTML and Javascript.
Theory:
Diffie-Hellman key exchange is a method of digital encryption that securely exchanges cryptographic keys between two parties over a public channel without their conversation being transmitted over the internet. The two parties use symmetric cryptography to encrypt and decrypt their messages. Diffie-Hellman key exchange is commonly found in security protocols, such as Transport Layer Security (TLS), Secure Shell (SSH) and IP Security (IPsec). 
The Diffie-Hellman algorithm is being used to establish a shared secret that can be used for secret communications while exchanging data over a public network using the elliptic curve to generate points and get the secret key using the parameters.  
For the sake of simplicity and practical implementation of the algorithm, we will consider only 4 variables, one prime P and G (a primitive root of P) and two private values a and b.
P and G are both publicly available numbers. Users (say Alice and Bob) pick private values a and b and they generate a key and exchange it publicly. The opposite person receives the key and that generates a secret key, after which they have the same secret key to encrypt.
	Program:

<html>
<head>
<title>Diffie-Hellman Key Exchange</title>
<meta name="viewport" content="width=device-width, initialscale=1.0">
</head>
<body>
<h1 style="text-align: center;">Diffie-Hellman Key Exchange</h1>
<h2 style="text-align: center;">Implemented Using HTML & Javascript</h2>
<hr>
<table class="center">
<tr>
<td>Enter Public Key-P:</td>
<td><input type="number" id="P"></td>
</tr>
<tr>
<td>Enter Public Key-G :</td>
<td><input type="number" id="G"></p>
</td>
</tr>
<tr>
<td>Enter private key for Alice:</td>
<td><input type="number" id="A"></td>
</tr>
<tr>
<td>Enter private key for Bob:</td>
<td><input type="number" id="B"></p>
</td>
</tr>
</tr>
<tr>
<td><button onclick="dh(A, B, P);">Get Secret Keys for Alice and Bob</button></td>
</tr>
<tr>
<td>Secret key for the Alice is:</td>
<td>
<p id="ka"></p>
</td>
</tr>
<tr>
<td>Secret key for the Bob is:</td>
<td>
<p id="kb"></p>
</td>
</tr>    
</table>
   
    </body>
    <style>
        .center {
  margin-left: auto;
  margin-right: auto;
}
    </style>

<script type="text/javascript">

// This program calculates the Key for two persons
// using the Diffie-Hellman Key exchange algorithm

// Power function to return value of a ^ b mod P
function dh(A, B, P)
{

	if (B == 1)
		return A;
	else
		return((Math.pow(A, B)) % P);
}
// Driver code
var P, G, x, A, y, B, ka, kb;

// Both the persons will be agreed upon the public keys G and P

// A primitive root for P, G is taken
P = document.getElementById('P').value;
G = document.getElementById('G').value;

// Alice will choose the private key a
// a is the chosen private key
A = document.getElementById('A').value;

// Bob will choose the private key b
// b is the chosen private key
B = document.getElementById('B').value;

// Gets the generated key
x = power(G, A, P);
y = power(G, B, P);

// Generating the secret key after the exchange of keys
ka = power(y, A, P); // Secret key for Alice
kb = power(x, B, P); // Secret key for Bob
}
document.getElementById(' ka ').innerHTML = ka ;
document.getElementById(' kb ').innerHTML = kb ;

</script>
</html>
	
</code>

</body>
</html>
